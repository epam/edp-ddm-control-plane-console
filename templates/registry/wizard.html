{{ define "wizard" }}
    <div class="reg-wizard">
        <div class="wizard-contents">
            <ul>
                <template v-for="(tab, tabName) in wizard.tabs">
                    <li :class="{ active: wizard.activeTab == tabName }"
                        v-if="tab.visible">
                        <a @click="selectWizardTab(tabName, $event)" href="#">[[ tab.title ]]</a>
                    </li>
                </template>
                {{if .hasUpdate}}
                    <li>
                        <a href="/admin/registry/update/{{.registry.Name}}">Оновити реєстр</a>
                    </li>
                {{end}}
            </ul>
        </div>
        <div class="wizard-body">
            <form id="create-form" @submit="registryFormSubmit" class="registry-create-form wizard-form" method="post"
                  enctype="multipart/form-data" action="" ref="registryWizardForm">
                <input type="hidden" ref="wizardAction" name="action" value="{{ .action }}" />
                <input type="hidden" ref="registryData" value="{{ .registryData }}" />
                {{if .registryValues}}
                <input type="hidden" ref="registryValues" value="{{.registryValues}}" />
                {{end}}

                {{ if .error }}
                    <div class="rc-global-error">{{.error}}</div>
                {{ end }}
                <div class="wizard-tab" v-show="wizard.activeTab == 'general'">
                    <h2>Загальні налаштування</h2>
                    <div class="rc-title">
                        Увага! Назва повинна бути унікальною і її неможливо буде змінити після створення реєстру!
                    </div>
                    <div class="rc-form-group"
                         :class="{ 'error': wizard.tabs.general.requiredError || wizard.tabs.general.existsError || wizard.tabs.general.formatError }">
                        <label for="name">Назва реєстру</label>
                        <input {{ if eq .action "edit" }}disabled{{end}} type="text" id="name" name="name" maxlength="12"
                               v-model="wizard.tabs.general.registryName"
                               pattern="^[a-z0-9]([-a-z0-9]*[a-z0-9])?([a-z0-9]([-a-z0-9]*[a-z0-9])?)*$" />
                        <span v-if="wizard.tabs.general.requiredError">Обов’язкове поле</span>
                        <span v-if="wizard.tabs.general.existsError">Реєстр з такою назвою вже існує</span>
                        <span v-if="wizard.tabs.general.formatError">Будь-ласка вкажіть назву у відповідному форматі</span>
                        <p>Допустимі символи: "a-z", "-". Назва не може перевищувати довжину у 12 символів.</p>
                    </div>

                    <div class="rc-form-group">
                        <label for="description">Опис</label>
                        <textarea rows="3" name="description" id="description" maxlength="250">{{.model.Description}}</textarea>
                        <p>Опис може містити офіційну назву реєстру чи його призначення.</p>
                    </div>
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'administrators'">
                    <h2>Адміністратори</h2>
                    <div :class="{ error: wizard.tabs.administrators.requiredError }"
                         class="rc-form-group administrators">
                        <input type="hidden" id="admins" name="admins" v-model="adminsValue" :admins="loadAdmins('{{ .model.Admins }}')" />
                        <input type="checkbox" style="display: none;" v-model="adminsChanged" checked="checked" name="admins-changed" />

                        <div class="advanced-admins" ref="admins">
                            <div v-cloak v-for="adm in admins" class="child-admin">
                                [[ adm.email ]]
                                <a @click="deleteAdmin" :email="adm.email" href="#">
                                    <img src="/static/img/action-delete.png" />
                                </a>
                            </div>
                            <button type="button" @click="showAdminForm">+</button>
                        </div>
                        <span v-if="wizard.tabs.administrators.requiredError">Обов’язкове поле</span>
                        <p>Допустимі символи: "0-9", "a-z", "_", "-", "@", ".", ",".</p>
                    </div>
                </div>
                {{ if eq .action "create" }}
                <div class="wizard-tab" v-show="wizard.activeTab == 'template'">
                    <h2>Налаштування шаблону реєстру</h2>
                    <input type="hidden" id="preload-registry-branches" ref="registryBranches"
                           value="{{ .gerritBranches }}" />
                    <div class="rc-form-group"
                         :class="{'error': wizard.tabs.template.templateRequiredError}">
                        <label for="registry-git-template">Шаблон реєстру</label>
                        <select name="registry-git-template" id="registry-git-template"
                                v-model="wizard.tabs.template.registryTemplate" @change="changeTemplateProject">
                            <option></option>
                            {{range $key, $val := .gerritProjects}}
                                <option {{ if eq $.model.RegistryGitTemplate $val.Spec.Name }}selected="selected"{{end}}>{{$val.Spec.Name}}</option>
                            {{end}}
                        </select>
                        <span v-if="wizard.tabs.template.templateRequiredError">Обов’язкове поле</span>
                    </div>
                    <div class="rc-form-group"
                         :class="{'error': wizard.tabs.template.branchRequiredError}">
                        <label for="registry-git-branch">Гілка шаблону реєстру</label>
                        <select name="registry-git-branch" id="registry-git-branch"
                                v-model="wizard.tabs.template.registryBranch">
                            <option v-for="branch in wizard.tabs.template.branches">[[ branch ]]</option>
                        </select>
                        <span v-if="wizard.tabs.template.branchRequiredError">Обов’язкове поле</span>
                    </div>
                </div>
                {{end}}
                <div class="wizard-tab" v-show="wizard.activeTab == 'mail'">
                    {{template "reg-smtp" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'key'">
                    {{template "key-form" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'resources'">
                    {{template "registry-resources" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'dns'">
                    {{template "reg-dns" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'cidr'">
                    {{template "cidr-block" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'supplierAuthentication'">
                    {{template "supplier-auth" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'recipientAuthentication'">
                    {{template "recipient-auth" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'backupSchedule'">
                    {{template "backup-schedule" .}}
                </div>
                <div class="wizard-tab" v-show="wizard.activeTab == 'confirmation'">
                    <h2>Підтвердження</h2>
                    <p>Усе готово для створення реєстру. Ви можете перевірити внесені дані або натисніть "Створити реєстр".</p>
                </div>
                <div class="wizard-buttons" :class="{ 'no-prev': wizard.activeTab == 'general' }">
                    {{ if eq .action "create" }}
                    <button class="wizard-prev" @click="wizardPrev" v-show="wizard.activeTab != 'general'" type="button">Назад</button>
                    <button class="wizard-next" @click="wizardNext" v-show="wizard.activeTab != 'confirmation'" type="button">Далі</button>
                    <button class="wizard-next" type="submit" name="submit" v-show="wizard.activeTab == 'confirmation'">Створити реєстр</button>
                    {{end}}

                    {{ if eq .action "edit" }}
                    <button v-show="wizard.activeTab != 'update'" class="wizard-next" type="button"
                            @click="wizardEditSubmit">Підтвердити</button>
                    {{end}}
                </div>
            </form>
        </div>
    </div>
{{end}}